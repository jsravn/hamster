---
- name: system | enable persistent journal log
  copy: src=journald.conf dest=/etc/systemd/journald.conf
  notify: restart journald

- name: system | update apt
  command: apt update
  when: r is changed

- name: system | install useful packages
  package: name={{ item }} state=present
  with_items:
    - vim
    - tmux
    - conntrack
    - htop
    - curl

- name: system | install intel microcode updates
  package: name=intel-microcode state=present

- name: system | install unattended upgrades
  package: name={{ item }} state=present
  with_items:
    - unattended-upgrades

- name: system | configure unattended upgrades
  template: src={{ item }} dest=/etc/apt/apt.conf.d/{{ item }}
  with_items:
    - 50unattended-upgrades
    - 20auto-upgrades
